# $Id: Makefile 119 2007-02-11 16:16:11Z dme26 $
#
# BOB Makefile

.phony: info election configPerms clear clean

files = AUTHORS COPYING INSTALL Makefile electionConfig.pm genElection.pl rollcheck.php vote.php BOB.php admin_checkvoter.php admin_checkcount.php admin_dump.php admin_results.php showvotes.php
genLiveFiles = config.php vote.txt ballot.html .htaccess
genStubFiles = createtable.sql voters.sql printelection.sql

release = 0.6
archiveName = BOB$(release).tar.gz

info:
	# NOTE: You should edit electionConfig.pm before making the election target
	#
	# Targets:
	#
	# election: run the Perl script genElection.pl
	# clear: remove generated stub files (e.g. SQL import templates)
	# clean: remove all files generated by genElection.pl (including .htaccess)
	# archive: create a tar file of this directory
	# 

archive:	configPerms $(archiveName)

configPerms:
	chmod 644 AUTHORS COPYING INSTALL Makefile rollcheck.php vote.php BOB.php
	chmod 600 electionConfig.pm 
	chmod 700 genElection.pl 

election:
	./genElection.pl

$(archiveName): $(files)
	tar -zcvf $(archiveName) --exclude CVS --exclude *~ $(files)

clear:
	rm -f $(genStubFiles)

clean: clear
	rm -f $(genLiveFiles) *~ $(archiveName)
